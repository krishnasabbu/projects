package com.chat.controller;

import com.chat.model.TranslateCriteria;
import com.chat.services.ChatService;
import com.chat.services.GithubAPIService;
import org.json.JSONObject;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.util.StringUtils;
import org.springframework.web.bind.annotation.*;

import java.io.IOException;
import java.util.Map;

@RestController
public class ChatController {

    @Autowired
    private ChatService chatService;

    @Autowired
    private GithubAPIService githubAPIService;


    @GetMapping("/check")
    public void check() {
        String payload = "{\"action\":\"opened\",\"number\":8,\"pull_request\":{\"url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8\",\"id\":1253055625,\"node_id\":\"PR_kwDOJBilKs5KsByJ\",\"html_url\":\"https://github.com/test-160693/test-js-project/pull/8\",\"diff_url\":\"https://github.com/test-160693/test-js-project/pull/8.diff\",\"patch_url\":\"https://github.com/test-160693/test-js-project/pull/8.patch\",\"issue_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/8\",\"number\":8,\"state\":\"open\",\"locked\":false,\"title\":\"Develop testing\",\"user\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"body\":\"Develop testing\",\"created_at\":\"2023-02-24T10:53:59Z\",\"updated_at\":\"2023-02-24T10:53:59Z\",\"closed_at\":null,\"merged_at\":null,\"merge_commit_sha\":null,\"assignee\":null,\"assignees\":[],\"requested_reviewers\":[],\"requested_teams\":[],\"labels\":[],\"milestone\":null,\"draft\":false,\"commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8/commits\",\"review_comments_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8/comments\",\"review_comment_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/comments{/number}\",\"comments_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/8/comments\",\"statuses_url\":\"https://api.github.com/repos/test-160693/test-js-project/statuses/8bf6549e8372ac03c74d3c0395f69d10ffbb2649\",\"head\":{\"label\":\"test-160693:develop\",\"ref\":\"develop\",\"sha\":\"8bf6549e8372ac03c74d3c0395f69d10ffbb2649\",\"user\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":605594922,\"node_id\":\"R_kgDOJBilKg\",\"name\":\"test-js-project\",\"full_name\":\"test-160693/test-js-project\",\"private\":false,\"owner\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/test-160693/test-js-project\",\"description\":\"javascript test project\",\"fork\":false,\"url\":\"https://api.github.com/repos/test-160693/test-js-project\",\"forks_url\":\"https://api.github.com/repos/test-160693/test-js-project/forks\",\"keys_url\":\"https://api.github.com/repos/test-160693/test-js-project/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/test-160693/test-js-project/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/test-160693/test-js-project/teams\",\"hooks_url\":\"https://api.github.com/repos/test-160693/test-js-project/hooks\",\"issue_events_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/test-160693/test-js-project/events\",\"assignees_url\":\"https://api.github.com/repos/test-160693/test-js-project/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/test-160693/test-js-project/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/tags\",\"blobs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/test-160693/test-js-project/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/test-160693/test-js-project/languages\",\"stargazers_url\":\"https://api.github.com/repos/test-160693/test-js-project/stargazers\",\"contributors_url\":\"https://api.github.com/repos/test-160693/test-js-project/contributors\",\"subscribers_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscribers\",\"subscription_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscription\",\"commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/test-160693/test-js-project/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/test-160693/test-js-project/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/test-160693/test-js-project/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/test-160693/test-js-project/merges\",\"archive_url\":\"https://api.github.com/repos/test-160693/test-js-project/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/test-160693/test-js-project/downloads\",\"issues_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/test-160693/test-js-project/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/test-160693/test-js-project/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/test-160693/test-js-project/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/test-160693/test-js-project/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/test-160693/test-js-project/deployments\",\"created_at\":\"2023-02-23T13:48:21Z\",\"updated_at\":\"2023-02-23T13:52:27Z\",\"pushed_at\":\"2023-02-24T10:54:00Z\",\"git_url\":\"git://github.com/test-160693/test-js-project.git\",\"ssh_url\":\"git@github.com:test-160693/test-js-project.git\",\"clone_url\":\"https://github.com/test-160693/test-js-project.git\",\"svn_url\":\"https://github.com/test-160693/test-js-project\",\"homepage\":null,\"size\":6,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"JavaScript\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"has_discussions\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1,\"license\":null,\"allow_forking\":true,\"is_template\":false,\"web_commit_signoff_required\":false,\"topics\":[],\"visibility\":\"public\",\"forks\":0,\"open_issues\":1,\"watchers\":0,\"default_branch\":\"master\",\"allow_squash_merge\":true,\"allow_merge_commit\":true,\"allow_rebase_merge\":true,\"allow_auto_merge\":false,\"delete_branch_on_merge\":false,\"allow_update_branch\":false,\"use_squash_pr_title_as_default\":false,\"squash_merge_commit_message\":\"COMMIT_MESSAGES\",\"squash_merge_commit_title\":\"COMMIT_OR_PR_TITLE\",\"merge_commit_message\":\"PR_TITLE\",\"merge_commit_title\":\"MERGE_MESSAGE\"}},\"base\":{\"label\":\"test-160693:master\",\"ref\":\"master\",\"sha\":\"79c531ee25adfd96214e76efe48793056fe6eab2\",\"user\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"repo\":{\"id\":605594922,\"node_id\":\"R_kgDOJBilKg\",\"name\":\"test-js-project\",\"full_name\":\"test-160693/test-js-project\",\"private\":false,\"owner\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/test-160693/test-js-project\",\"description\":\"javascript test project\",\"fork\":false,\"url\":\"https://api.github.com/repos/test-160693/test-js-project\",\"forks_url\":\"https://api.github.com/repos/test-160693/test-js-project/forks\",\"keys_url\":\"https://api.github.com/repos/test-160693/test-js-project/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/test-160693/test-js-project/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/test-160693/test-js-project/teams\",\"hooks_url\":\"https://api.github.com/repos/test-160693/test-js-project/hooks\",\"issue_events_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/test-160693/test-js-project/events\",\"assignees_url\":\"https://api.github.com/repos/test-160693/test-js-project/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/test-160693/test-js-project/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/tags\",\"blobs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/test-160693/test-js-project/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/test-160693/test-js-project/languages\",\"stargazers_url\":\"https://api.github.com/repos/test-160693/test-js-project/stargazers\",\"contributors_url\":\"https://api.github.com/repos/test-160693/test-js-project/contributors\",\"subscribers_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscribers\",\"subscription_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscription\",\"commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/test-160693/test-js-project/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/test-160693/test-js-project/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/test-160693/test-js-project/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/test-160693/test-js-project/merges\",\"archive_url\":\"https://api.github.com/repos/test-160693/test-js-project/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/test-160693/test-js-project/downloads\",\"issues_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/test-160693/test-js-project/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/test-160693/test-js-project/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/test-160693/test-js-project/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/test-160693/test-js-project/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/test-160693/test-js-project/deployments\",\"created_at\":\"2023-02-23T13:48:21Z\",\"updated_at\":\"2023-02-23T13:52:27Z\",\"pushed_at\":\"2023-02-24T10:54:00Z\",\"git_url\":\"git://github.com/test-160693/test-js-project.git\",\"ssh_url\":\"git@github.com:test-160693/test-js-project.git\",\"clone_url\":\"https://github.com/test-160693/test-js-project.git\",\"svn_url\":\"https://github.com/test-160693/test-js-project\",\"homepage\":null,\"size\":6,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"JavaScript\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"has_discussions\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1,\"license\":null,\"allow_forking\":true,\"is_template\":false,\"web_commit_signoff_required\":false,\"topics\":[],\"visibility\":\"public\",\"forks\":0,\"open_issues\":1,\"watchers\":0,\"default_branch\":\"master\",\"allow_squash_merge\":true,\"allow_merge_commit\":true,\"allow_rebase_merge\":true,\"allow_auto_merge\":false,\"delete_branch_on_merge\":false,\"allow_update_branch\":false,\"use_squash_pr_title_as_default\":false,\"squash_merge_commit_message\":\"COMMIT_MESSAGES\",\"squash_merge_commit_title\":\"COMMIT_OR_PR_TITLE\",\"merge_commit_message\":\"PR_TITLE\",\"merge_commit_title\":\"MERGE_MESSAGE\"}},\"_links\":{\"self\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8\"},\"html\":{\"href\":\"https://github.com/test-160693/test-js-project/pull/8\"},\"issue\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/issues/8\"},\"comments\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/issues/8/comments\"},\"review_comments\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8/comments\"},\"review_comment\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/comments{/number}\"},\"commits\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/pulls/8/commits\"},\"statuses\":{\"href\":\"https://api.github.com/repos/test-160693/test-js-project/statuses/8bf6549e8372ac03c74d3c0395f69d10ffbb2649\"}},\"author_association\":\"OWNER\",\"auto_merge\":null,\"active_lock_reason\":null,\"merged\":false,\"mergeable\":null,\"rebaseable\":null,\"mergeable_state\":\"unknown\",\"merged_by\":null,\"comments\":0,\"review_comments\":0,\"maintainer_can_modify\":false,\"commits\":2,\"additions\":2,\"deletions\":0,\"changed_files\":2},\"repository\":{\"id\":605594922,\"node_id\":\"R_kgDOJBilKg\",\"name\":\"test-js-project\",\"full_name\":\"test-160693/test-js-project\",\"private\":false,\"owner\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/test-160693/test-js-project\",\"description\":\"javascript test project\",\"fork\":false,\"url\":\"https://api.github.com/repos/test-160693/test-js-project\",\"forks_url\":\"https://api.github.com/repos/test-160693/test-js-project/forks\",\"keys_url\":\"https://api.github.com/repos/test-160693/test-js-project/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/test-160693/test-js-project/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/test-160693/test-js-project/teams\",\"hooks_url\":\"https://api.github.com/repos/test-160693/test-js-project/hooks\",\"issue_events_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/test-160693/test-js-project/events\",\"assignees_url\":\"https://api.github.com/repos/test-160693/test-js-project/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/test-160693/test-js-project/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/tags\",\"blobs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/test-160693/test-js-project/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/test-160693/test-js-project/languages\",\"stargazers_url\":\"https://api.github.com/repos/test-160693/test-js-project/stargazers\",\"contributors_url\":\"https://api.github.com/repos/test-160693/test-js-project/contributors\",\"subscribers_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscribers\",\"subscription_url\":\"https://api.github.com/repos/test-160693/test-js-project/subscription\",\"commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/test-160693/test-js-project/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/test-160693/test-js-project/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/test-160693/test-js-project/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/test-160693/test-js-project/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/test-160693/test-js-project/merges\",\"archive_url\":\"https://api.github.com/repos/test-160693/test-js-project/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/test-160693/test-js-project/downloads\",\"issues_url\":\"https://api.github.com/repos/test-160693/test-js-project/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/test-160693/test-js-project/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/test-160693/test-js-project/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/test-160693/test-js-project/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/test-160693/test-js-project/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/test-160693/test-js-project/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/test-160693/test-js-project/deployments\",\"created_at\":\"2023-02-23T13:48:21Z\",\"updated_at\":\"2023-02-23T13:52:27Z\",\"pushed_at\":\"2023-02-24T10:54:00Z\",\"git_url\":\"git://github.com/test-160693/test-js-project.git\",\"ssh_url\":\"git@github.com:test-160693/test-js-project.git\",\"clone_url\":\"https://github.com/test-160693/test-js-project.git\",\"svn_url\":\"https://github.com/test-160693/test-js-project\",\"homepage\":null,\"size\":6,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"JavaScript\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"has_discussions\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":1,\"license\":null,\"allow_forking\":true,\"is_template\":false,\"web_commit_signoff_required\":false,\"topics\":[],\"visibility\":\"public\",\"forks\":0,\"open_issues\":1,\"watchers\":0,\"default_branch\":\"master\"},\"sender\":{\"login\":\"test-160693\",\"id\":126173395,\"node_id\":\"U_kgDOB4VA0w\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/126173395?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/test-160693\",\"html_url\":\"https://github.com/test-160693\",\"followers_url\":\"https://api.github.com/users/test-160693/followers\",\"following_url\":\"https://api.github.com/users/test-160693/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/test-160693/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/test-160693/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/test-160693/subscriptions\",\"organizations_url\":\"https://api.github.com/users/test-160693/orgs\",\"repos_url\":\"https://api.github.com/users/test-160693/repos\",\"events_url\":\"https://api.github.com/users/test-160693/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/test-160693/received_events\",\"type\":\"User\",\"site_admin\":false}}\n";
        if(StringUtils.hasText(payload)) {
            //System.out.println("payload ==== "+payload);
            githubAPIService.reviewChangesAndPostComment(payload);
        }
    }

    @PostMapping("/prcheck")
    public void prcheck(@RequestBody String payload){
        if(StringUtils.hasText(payload)) {
            githubAPIService.reviewChangesAndPostComment(payload);
        }
    }



    /*@PostMapping("/api/v1/chat")
    public ResponseEntity<?> chat(@RequestBody Map<String, String> chatMap) {
        String type = chatMap.get("chatGPTType");
        if("language".equalsIgnoreCase(type)) {
            return ResponseEntity.ok(chatService.chatWithGPT(chatMap.get("language"), true));
        }else if("chatModel".equalsIgnoreCase(type)) {
            return ResponseEntity.ok(chatService.chatWithGPT(chatMap.get("data"), false));
        }else if("codeReview".equalsIgnoreCase(type)) {
            return ResponseEntity.ok(chatService.codeReviewWithGPT(chatMap.get("data")));
        }
        return ResponseEntity.ok(chatService.chatWithTrainedModel(chatMap.get("data")));
    }*/

    @PostMapping("/api/v1/chat")
    public ResponseEntity<?> chat(@RequestBody Map<String, String> chatMap) {
        String question = chatMap.get("data");
        TranslateCriteria translateCriteria = new TranslateCriteria();
        translateCriteria.setText(question);
        translateCriteria = chatService.getAnswer(translateCriteria);
        System.out.println(translateCriteria.getText());
        return ResponseEntity.ok(translateCriteria);
    }

    @PostMapping("/api/v1/chat1")
    public ResponseEntity<?> chat1(@RequestBody Map<String, String> chatMap) {
        String question = chatMap.get("data");
        TranslateCriteria translateCriteria = new TranslateCriteria();
        translateCriteria.setText(question);
        /*translateCriteria = chatService.getAnswer(translateCriteria);
        System.out.println(translateCriteria.getText());*/
        return ResponseEntity.ok(chatService.chatWithTrainedModel(chatMap.get("data")));
    }



    @PostMapping("/api/v1/dl")
    public ResponseEntity<?> dl(@RequestBody String text) throws IOException {
        TranslateCriteria translateCriteria = new TranslateCriteria();
        translateCriteria.setText(text);
        translateCriteria = chatService.getDLDetails_backup(translateCriteria);
        System.out.println(translateCriteria.getText());
        return ResponseEntity.ok(translateCriteria.getText());
    }

    @PostMapping("/api/v1/submit")
    public ResponseEntity<?> submitCard(@RequestBody String type) throws IOException {
        StringBuilder sb = new StringBuilder();
        if("final".equalsIgnoreCase(type)) {
            sb.append("Email Sent Successfully..  Please check your inbox. <br/> Is there any thing else I may assist..");
        }else {
            sb.append("Thanks for applying credit card... <br/> Please enter your email id : <input type='text' name='email'> <br/>");
            sb.append("<div class='quick-links'><div class='quick-link' id='finalSubmit'><div class='link'>Submit</div></div></div>");
        }
        return ResponseEntity.ok(sb.toString());
    }
}
